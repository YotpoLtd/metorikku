steps:
- dataFrameName: moviesWithRatings
  sql:
    SELECT concat_ws("-", userid, movies.movieid) as userkey,
           movies.movieid as movieId,
           rating,
           timestamp,
           title,
           genres,
           now() as ts,
           from_unixtime(timestamp, "yyyy/MM/dd") as date
    FROM ratings
    JOIN movies ON ratings.movieid = movies.movieid
    WHERE year(from_unixtime(timestamp))='2014'
output:
- dataFrameName: moviesWithRatings
  outputType: Hudi
  outputOptions:
    path: hoodie_test.parquet
    keyColumn: userkey
    timeColumn: ts
    partitionBy: date
    hivePartitions: year,month,day
    tableName: hoodie_test
